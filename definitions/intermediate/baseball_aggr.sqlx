config {
  type: "table",
  schema: "intermediate",
  assertions: {
    uniqueKey: ["gameId"],
    nonNull:["year"],
    rowConditions: [
      "year >= 2016",
      "dayNight = 'D'",
    ]
  }
}

SELECT gameId, gameNumber, year, type, duration, duration_minutes
FROM ${ref("baseball_schedules")}
WHERE dayNight = 'D' and year >= 2016